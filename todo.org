#+title: init emacs ^-^

* language

** uxn

   #+begin_src emacs-lisp :tangle ~/.emacs
   ;; ensure the directory containing uxntal-mode.el is mentioned
   ;; in emacs' load-path variable.
   (add-to-list 'load-path "~/.emacs.d/uxntal-mode/")

   ;; then load uxntal-mode
   (require 'uxntal-mode)
   #+end_src

** general seting

   Non-nil means print recursive structures using #N= and #N# syntax.

   #+begin_src emacs-lisp :tangle ~/.emacs
   (setq print-circle t)
   #+end_src

** shen

   #+begin_src emacs-lisp :tangle ~/.emacs
   (add-to-list 'load-path "~/.emacs.d/shen-mode/")
   (require 'shen-mode)
   #+end_src

** clojure

   #+begin_src emacs-lisp :tangle ~/.emacs
   (add-to-list 'load-path "~/.emacs.d/clojure-mode/")
   (require 'clojure-mode)

   (add-hook 'clojure-mode-hook #'enable-paredit-mode)
   (add-hook
    'clojure-mode-hook
    (lambda ()
      ;; (paren-face-mode)
      (local-set-key (kbd "C-x C-e") 'scheme-send-last-sexp-split-window)
      (local-set-key (kbd "C-c C-e") 'scheme-send-definition-split-window)
      (local-set-key (kbd "C-<tab>") 'scheme-easy-to-eval)))

   (defun run-clojure ()
     (interactive)
     ;; (run-scheme "java -cp /home/xyh/lang/clojure/clojure-1.8.0/clojure-1.8.0.jar clojure.main")
     (run-scheme "lein repl"))
   #+end_src

** julia

   #+begin_src emacs-lisp :tangle ~/.emacs
   (add-to-list 'load-path "~/.emacs.d/julia-emacs/")
   (require 'julia-mode)
   #+end_src

** cicada

   #+begin_src emacs-lisp :tangle ~/.emacs
   (add-to-list 'load-path "~/.emacs.d/cicada-mode/")
   (require 'cicada-mode)

   (add-to-list 'interpreter-mode-alist '("cicada" . cicada-mode))

   (add-hook
    'cicada-mode-hook
    (lambda ()
      (turn-off-indent)))

   (add-to-list 'auto-mode-alist '("\\.cic\\'" . cicada-mode))
   (add-to-list 'auto-mode-alist '("\\.ch\\'" . cicada-mode))
   #+end_src

** web

*** typescript-mode

    #+begin_src emacs-lisp :tangle ~/.emacs
    (add-to-list 'load-path "~/.emacs.d/typescript.el/")
    (require 'typescript-mode)

    (add-hook
     'typescript-mode-hook
     (lambda ()
       (setq typescript-indent-level 2)
       (setq tab-width 2)))

    (add-to-list 'auto-mode-alist '("\\.js\\'" . typescript-mode))
    (add-to-list 'auto-mode-alist '("\\.mjs\\'" . typescript-mode))
    (add-to-list 'auto-mode-alist '("\\.cjs\\'" . typescript-mode))
    (add-to-list 'auto-mode-alist '("\\.ts\\'" . typescript-mode))
    (add-to-list 'auto-mode-alist '("\\.d.ts\\'" . typescript-mode))
    #+end_src

*** web-mode

    #+begin_src emacs-lisp :tangle ~/.emacs
    (add-to-list 'load-path "~/.emacs.d/web-mode/")
    (require 'web-mode)

    (add-to-list 'auto-mode-alist '("\\.jsx\\'" . web-mode))
    (add-to-list 'auto-mode-alist '("\\.tsx\\'" . web-mode))
    (add-to-list 'auto-mode-alist '("\\.svelte\\'" . web-mode))
    (add-to-list 'auto-mode-alist '("\\.vue\\'" . web-mode))
    (add-to-list 'auto-mode-alist '("\\.mimor\\'" . web-mode))

    (define-key web-mode-map (kbd "C-c C-c") 'web-mode-tag-match)

    (setq web-mode-enable-auto-indentation nil)
    (setq web-mode-markup-indent-offset 2)
    (setq web-mode-css-indent-offset 2)
    (setq web-mode-code-indent-offset 2)
    (setq web-mode-style-padding 0)
    (setq web-mode-script-padding 0)
    #+end_src

*** css-mode

    #+begin_src emacs-lisp :tangle ~/.emacs
    (setq css-indent-offset 2)
    #+end_src

*** html-mode

    #+begin_src emacs-lisp :tangle ~/.emacs
    (add-hook
     'html-mode-hook
     (lambda ()
       (set (make-local-variable 'sgml-basic-offset) 2)
       ))
    #+end_src

*** emmet-mode -- quick expend

    #+begin_src emacs-lisp :tangle ~/.emacs
    (add-to-list 'load-path "~/.emacs.d/emmet-mode")
    (require 'emmet-mode)

    (add-hook 'web-mode-hook 'emmet-mode)
    (add-hook 'web-mode-hook (lambda () (electric-indent-local-mode -1)))

    (add-to-list 'emmet-jsx-major-modes 'js-jsx-mode)
    (add-hook 'js-jsx-mode-hook
     (lambda () (define-key js-jsx-mode-map (kbd "C-j") 'emmet-expand-line)))

    (add-hook 'typescript-mode-hook
     (lambda () (define-key typescript-mode-map (kbd "C-j") 'emmet-expand-line)))
    #+end_src

*** wasm

    #+begin_src emacs-lisp :tangle ~/.emacs
    (add-to-list 'load-path "~/.emacs.d/wat-mode/")
    (require 'wat-mode)
    (add-to-list 'auto-mode-alist '("\\.wat\\'" . wat-mode))
    (add-to-list 'auto-mode-alist '("\\.wast\\'" . wat-mode))
    #+end_src

** txt

   #+begin_src emacs-lisp :tangle ~/.emacs
   (add-to-list 'auto-mode-alist '("\\.txt\\'" . text-mode))
   #+end_src

** python

   #+begin_src emacs-lisp :tangle ~/.emacs
   (setq python-indent-guess-indent-offset nil)
   (setq python-indent-offset 4)
   #+end_src

** rust

   #+begin_src emacs-lisp :tangle ~/.emacs
   (add-to-list 'load-path "~/.emacs.d/rust-mode/")
   (autoload 'rust-mode "rust-mode" nil t)
   (add-to-list 'auto-mode-alist '("\\.rs\\'" . rust-mode))
   (setq rust-indent-offset 4)
   #+end_src

** go

   #+begin_src emacs-lisp :tangle ~/.emacs
   (add-to-list 'load-path "~/.emacs.d/go-mode/")
   (require 'go-mode)

   (add-hook
    'go-mode-hook
    (lambda ()
      (setq tab-width 4)
      (setq indent-tabs-mode nil)))
   #+end_src

** forth
   #+begin_src emacs-lisp :tangle ~/.emacs
   (add-to-list 'load-path "~/.emacs.d/forth-mode/")

   (require 'forth-mode)
   (require 'forth-block-mode)
   (require 'forth-interaction-mode)

   (add-to-list 'auto-mode-alist '("\\.frt$" . forth-mode))
   (add-to-list 'auto-mode-alist '("\\.fth$" . forth-mode))
   (add-to-list 'auto-mode-alist '("\\.feline" . forth-mode))
   #+end_src

** sml
   #+begin_src emacs-lisp :tangle ~/.emacs
   (add-to-list 'load-path "~/.emacs.d/sml/")

   (autoload 'sml-mode "sml-mode" "Major mode for editing SML." t)
   (autoload 'run-sml "sml-proc" "Run an inferior SML process." t)
   (add-to-list 'auto-mode-alist '("\\.\\(sml\\|sig\\)\\'" . sml-mode))

   (setq sml-program-name "sml")
   ;; (setq sml-program-name "hamlet")

   (require 'sml-mode)

   (add-hook
    'sml-mode-hook
    (lambda ()
      (define-key sml-mode-map (kbd "C-x C-e") 'sml-send-function)
      (turn-off-indent)))
   #+end_src

** ocaml-mode
   #+begin_src emacs-lisp :tangle ~/.emacs
   (add-to-list 'load-path "~/.emacs.d/ocaml-mode/")

   (add-to-list 'auto-mode-alist '("\\.ml[iylp]?$" . caml-mode))
   (autoload 'caml-mode "caml" "Major mode for editing OCaml code." t)
   (autoload 'run-caml "inf-caml" "Run an inferior OCaml process." t)
   (autoload 'camldebug "camldebug" "Run ocamldebug on program." t)
   (add-to-list 'interpreter-mode-alist '("ocamlrun" . caml-mode))
   (add-to-list 'interpreter-mode-alist '("ocaml" . caml-mode))

   (if window-system (require 'caml-font))
   #+end_src

** agda

   #+begin_src emacs-lisp :tangle ~/.emacs
   (add-to-list 'load-path "~/.emacs.d/agda-mode/")

   (autoload 'agda2-mode "agda2-mode"
     "Major mode for editing Agda files (version â‰¥ 2)." t)

   (add-to-list 'auto-mode-alist '("\\.l?agda\\'" . agda2-mode))
   (modify-coding-system-alist 'file "\\.l?agda\\'" 'utf-8)

   (require 'agda2)

   (add-hook
    'agda2-mode-hook
    (lambda ()
      (turn-off-indent)))
   #+end_src

** c

   #+begin_src emacs-lisp :tangle ~/.emacs
   (setq c-basic-offset 4)
   (setq c-default-style "k&r")

   ;; (setq c-default-style "stroustrup")
   ;; (setq c-default-style "whitesmith")
   ;; (setq c-default-style "ellemtel")
   ;; (setq c-default-style "linux")

   (add-hook
    'c-mode-hook
    (lambda ()
      ;; (setq comment-style 'extra)
      (setq comment-start "//")
      (setq comment-end "")))
   #+end_src

** scala

   #+begin_src emacs-lisp :tangle ~/.emacs
   (add-to-list 'load-path "~/.emacs.d/emacs-scala-mode/")
   (require 'scala-mode)
   #+end_src

** lua

   #+begin_src emacs-lisp :tangle ~/.emacs
   (add-to-list 'load-path "~/.emacs.d/lua-mode/")

   (autoload 'lua-mode "lua-mode" "Lua editing mode." t)
   (add-to-list 'auto-mode-alist '("\\.lua$" . lua-mode))
   (add-to-list 'interpreter-mode-alist '("lua" . lua-mode))
   #+end_src

** yaml

   #+begin_src emacs-lisp :tangle ~/.emacs
   (add-to-list 'load-path "~/.emacs.d/yaml-mode/")
   (require 'yaml-mode)
   (add-to-list 'auto-mode-alist '("\\.yml$" . yaml-mode))
   #+end_src
